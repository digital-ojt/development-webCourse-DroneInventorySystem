<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/template :: layout(~{::title},~{::body/content()})}">

<head>
	<title>部品在庫一覧</title>
	<link rel="stylesheet" href="styles.css">
</head>

<body>
	<div class="card shadow mb-4">
		<div class="card-header py-3">
			<h6 class="m-0 font-weight-bold text-primary">部品在庫一覧</h6>
		</div>

		<div class="card-body">
			
			<div class="search-container">
				<!-- 検索フォーム -->
				<form class="form-inline" method="get" th:action="@{'/admin/stockList/search'}"
					th:object="${stockInfoForm}">
					<label for="searchTerm" class="mr-2 search-label">検索条件</label>
					<label for="searchTerm" class="mr-2">カテゴリー</label>
					<select id="searchTerm" name="categoryId" class="form-control mr-2">
						 <option value="">すべて</option>
						 <option th:each="category : ${session.categoryList}"
						         th:value="${category.categoryId}"
						         th:text="${category.categoryName}">
						 </option>
					</select>
					<label for="searchTerm" class="mr-2">名称</label>
					<input type="text" id="searchTerm" name="name" class="form-control mr-2" maxlength="20">
					<label for="searchTerm" class="mr-2">個数</label>
					<input type="number" id="searchTerm" name="amount" class="form-control mr-2" max="10000" min="0">
					<select id="searchTerm" name="amountCondition" class="form-control mr-2">
					    <option value="greater">以上</option>
					    <option value="less">以下</option>
					</select>
					<button type="submit" class="btn btn-primary">検索</button>
				</form>
				
				<!-- エラーメッセージの表示 -->
				<div th:if="${not #strings.isEmpty(errorMsg)}" class="text-danger">
					<p th:utext="${errorMsg}"></p>
				</div>
				
				<!-- DB登録成功メッセージの表示 -->
				<div th:if="${successMsg != null}" class="alert alert-success d-flex align-items-center">
					<p th:text="#{${successMsg}}"></p>
				</div>

				<!-- 新規登録 ボタン -->
				<div style="text-align: right; margin-top: 10px;">
					<a th:href="@{/admin/stockList/register}" type="submit" id="registerBtn"
						class="btn btn-success ml-2"
						style="background-color: #f8c471; border: none; border-radius: 5px;">新規登録
					</a>
				</div>
			</div>

			<!-- 在庫情報テーブル -->
			<h6 class="mb-3 font-weight-bold"></h6>
			<div class="table-responsive" style="height: 500px;">
				<div class="table-scrollable">
					<table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
						<thead>
							<tr>
								<th>カテゴリー</th>
								<th>名称</th>
								<th>個数</th>
								<th>保管場所</th>
								<th>説明</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="item : ${stockList}">
								<td>
									<a th:href="@{/admin/stockList/update/{stockId}(stockId=${item.stockId})}" 
									   th:text="${item.CategoryInfo.categoryName}"
									   style="text-decoration: underline;">
									</a>
								</td>
								<td> [[${item.name}]] </td>
								<td> [[${item.amount}]] </td>
								<td> [[${item.CenterInfo.centerName}]] </td>
								<td> [[${item.description}]] </td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</body>

</html>